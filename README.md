# Twitch

## 1. Тема и целевая аудитория

### Тема

Twitch - видеостриминговый сервис, специализирующийся на тематике компьютерных игр

### Целевая аудитория

- Twitch насчитывает 240 миллионов ежемесячных активных пользователей по всему миру. [[1](#использованные-источники)]
- В любой момент времени на Twitch происходит 98 056 прямых трансляций. [[1](#использованные-источники)]
- Пять стран, на которые приходится наибольший процент зрителей Twitch. [[1](#использованные-источники)]

| Страна               | Процент пользователей Twitch |
|----------------------|----------------------------------|
| Соединенные Штаты     | 29.08%                  |
| Бразилия             | 6.03%                     |
| Германия              | 4.55%                  |
| Япония              | 4.43%                  |
| Россия | 3.48%                  |

- Распределение пользователей по возрастам зрителей Twitch. [[1](#использованные-источники)]

| Возраст | Процентное соотношение |
|---------|-----------------------:|
|16 – 24  |	22.3%                    |
|25 – 34  |	49.7%                    |
|35 – 44  |	17.5%                    |
|45 – 54  |	7.4%                    |
|55 – 64  |	1.9%                    |
|65+      |	1.3%                     |

### MVP функционал:
- Ведение прямой трансляции
- Просмотр прямой трансляции
- Создание канала
- Профиль канала
- Подписка на каналы
- Отправка/получение сообщений в чате
- Поиск трансляций по категориям

### Ключевые продуктовые решения
- Бесконечная лента с трансляциями
- Рекомендации, основанные на истории просмотра категорий
- Подсчет статистики просмотра/ведения трансляции
- Сохранение записей трансляций

# 2. Расчет нагрузки для Twitch

## Основные данные для расчета нагрузки
- MAU - 240 млн. пользователей [[1](#использованные-источники)]
- В любой момент времени на Twitch происходит 98 056 прямых трансляций [[1](#использованные-источники)]
- Среднее время просмотра за день — 95 минут [[1](#использованные-источники)]
- В день загружается 2 млн новых трансляций [[1](#использованные-источники)]
- Средний размер трансляции (на час видео) составляет 3.6 ГБ [[1](#использованные-источники)]
- Максимальный размер записи трансляции — 4.5 ГБ/час [[1](#использованные-источники)]

## Публикация трансляций

### Продуктовые метрики
Средний месячный размер хранилища пользователя:
3.6 ГБ * (2 млн трансляций / 240 млн пользователей) * 30 дней = 0.9 ГБ

Средний размер хранилища пользователя за 5 лет:
0.9 ГБ * 12 месяцев * 5 лет = 54 ГБ

Среднее количество действий пользователя в день:
2 млн трансляций / 240 млн пользователей = 0.0083 трансляций

### Технические метрики
Пользователь в среднем выкладывает 0.0083 трансляции в день. Среднее количество запросов в секунду:
0.0083 * 240 000 000 / (24 * 60 * 60) = 23 RPS

Размер хранения трансляций:
54 ГБ * 240 000 000 / 1024 / 1024 = 12 675 ПБ

Максимальный размер записи трансляции:
4.5 ГБ/час * 2 млн трансляций * 1 час = 9 ПБ/день

Суммарный суточный трафик:
2 млн трансляций * 3.6 ГБ / 1024 = 7 031 ТБ/день


## Просмотр трансляций

### Продуктовые метрики
Средний размер хранения просмотра:
незначителен — хранить идентификаторы пользователя и просмотренные им трансляции.

Пользователь в среднем смотрит:
60 минут / трансляция * 95 минут = 1.58 трансляций/день


### Технические метрики
Пользователь в среднем смотрит 1.58 трансляций в день. Среднее количество запросов в секунду:
1.58 * 240 000 000 / (24 * 60 * 60) = 4 389 RPS


За 1 час просмотра примерно 3.6 ГБ данных.

Суммарный суточный трафик:
1.58 трансляций * 3.6 ГБ * 240 млн пользователей / 1024 = 1 330 781 ТБ/день


## Создание канала
Ежедневно создается большое количество новых каналов. Оценим количество регистраций:
50 000 новых каналов / 24 / 60 / 60 = 0.57 регистраций/секунду


## Подписки на каналы
Средний пользователь подписывается на 5 каналов в месяц. Среднее количество подписок:
5 подписок * 240 млн пользователей / 30 дней = 40 млн подписок/день

Среднее количество подписок в секунду:
40 млн / (24 * 60 * 60) = 463 подписок/секунду


## Сообщения в чате
Количество сообщений в чате значительно варьируется. Предположим, что пользователь отправляет в среднем 2 сообщения в день:
2 сообщения * 240 млн пользователей = 480 млн сообщений/день

Среднее количество сообщений в секунду:
480 млн / (24 * 60 * 60) = 5 555 сообщений/секунду


## Таблицы

### Продуктовые метрики
| Действие               | Средний размер хранилища пользователя (ГБ) | Среднее количество действий пользователя в день |
|------------------------|--------------------------------------------|-------------------------------------------------|
| Публикация трансляций   | 0.9                                        | 0.0083                                          |
| Просмотр трансляций     | Незначителен                               | 1.58                                            |

### Технические метрики
| Действие               | Размер хранения (ПБ)   | Пиковое потребление (Тбит/с) | Суммарный суточный трафик (ТБ) |
|------------------------|------------------------|------------------------------|--------------------------------|
| Публикация трансляций   | 12 675                 | 9                            | 7 031                          |
| Просмотр трансляций     | Незначителен           | —                            | 1 330 781                      |

### RPS
| Действие               | RPS     |
|------------------------|---------|
| Публикация трансляций   | 23      |
| Просмотр трансляций     | 4 389   |
| Создание каналов        | 0.57    |
| Подписки на каналы      | 463     |
| Сообщения в чате        | 5 555   |



### Использованные источники

[1. Twitch Usage and Growth Statistics: How Many People Use Twitch? (2024 Statistics)
Written by Brian Dean / Sep. 05, 2024](https://backlinko.com/twitch-users)
